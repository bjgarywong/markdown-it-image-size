var r;function e(e){return e>=r.NUMBER_ZERO&&e<=r.NUMBER_NINE}function i(i,t,n){var o=function(i,t,n){for(var o=i;o<t;o+=1){var E=n.charCodeAt(o);if(!e(E)&&E!==r.PERCENTAGE)return o}return t}(t,n,i);return{position:o,value:i.slice(t,o)}}!function(r){r[r.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",r[r.OPENING_BRACKET=91]="OPENING_BRACKET",r[r.OPENING_PARENTHESIS=40]="OPENING_PARENTHESIS",r[r.WHITESPACE=32]="WHITESPACE",r[r.NEW_LINE=10]="NEW_LINE",r[r.EQUALS=61]="EQUALS",r[r.LOWER_CASE_X=120]="LOWER_CASE_X",r[r.NUMBER_ZERO=48]="NUMBER_ZERO",r[r.NUMBER_NINE=57]="NUMBER_NINE",r[r.PERCENTAGE=37]="PERCENTAGE"}(r||(r={}));var t=function(e,i){for(var t=e;t<i.posMax;){var n=i.src.charCodeAt(t);if(n!==r.WHITESPACE&&n!==r.NEW_LINE)break;t+=1}return t},n=function(e,n){var o,E,a,s="",c="",N="",A=e.pos,p=e.posMax;if(!function(e){return e.src.charCodeAt(e.pos)===r.EXCLAMATION_MARK&&e.src.charCodeAt(e.pos+1)===r.OPENING_BRACKET}(e))return!1;var f=e.pos+2,h=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(h<0)return!1;if((o=h+1)<p&&e.src.charCodeAt(o)===r.OPENING_PARENTHESIS){if((o=t(o+=1,e))>=p)return!1;var u=function(r,e){var i=r.md.helpers.parseLinkDestination(r.src,e,r.posMax);if(i.ok){var t=r.md.normalizeLink(i.str);return r.md.validateLink(t)?{position:i.pos,href:t}:{position:e,href:""}}}(e,o);if(!u)return!1;s=u.href,a=o=u.position,o=t(o,e);var v=e.md.helpers.parseLinkTitle(e.src,o,e.posMax);o<p&&a!==o&&v.ok?(E=v.str,o=t(o=v.pos,e)):E="";var d=function(e,n){if(!(e-1<0)&&n.src.charCodeAt(e-1)===r.WHITESPACE){var o=function(e,t,n){if(!(t>=n)){var o=t;if(e.charCodeAt(o)===r.EQUALS&&((s=e.charCodeAt(o+=1))===r.LOWER_CASE_X||s>=r.NUMBER_ZERO&&s<=r.NUMBER_NINE)){var E=i(e,o,n);if(e.charCodeAt(o=E.position)===r.LOWER_CASE_X){var a=i(e,o+=1,n);return{width:E.value,height:a.value,position:o=a.position}}}}var s}(n.src,e,n.posMax);if(o)return{position:t(o.position,n),width:o.width,height:o.height}}}(o,e);if(d&&(o=d.position,c=d.width,N=d.height),o>=p||41!==e.src.charCodeAt(o))return e.pos=A,!1;o+=1}else{if(void 0===e.env.references)return!1;var R;(o=t(o,e))<p&&91===e.src.charCodeAt(o)?(a=o+1,(o=e.md.helpers.parseLinkLabel(e,o))>=0?R=e.src.slice(a,o+=1):o=h+1):o=h+1,R||(R=e.src.slice(f,h));var l=e.env.references[e.md.utils.normalizeReference(R)];if(!l)return e.pos=A,!1;s=l.href,E=l.title}return n||(""==c&&""==N&&(c="100%"),function(r,e,i,t,n,o,E){r.pos=e,r.posMax=i;var a=r.push("image","img",0);a.children=[];var s=new r.md.inline.State(r.src.slice(e,i),r.md,r.env,a.children);s.md.inline.tokenize(s),a.attrSet("src",t),a.attrSet("alt",""),n&&a.attrSet("title",n),""!==o&&a.attrSet("width",o),""!==E&&a.attrSet("height",E)}(e,f,h,s,E,c,N)),e.pos=o,e.posMax=p,!0};exports.imageSize=function(r){r.inline.ruler.before("emphasis","image",n)};
//# sourceMappingURL=index.cjs.map
